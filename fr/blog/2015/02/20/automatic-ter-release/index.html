<!DOCTYPE html>
<html>
    <head>
        <title>Publication automatique sur le TER depuis Github &mdash; &lt;fabarea/&gt; &mdash; To Get You Started</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/fr/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/fr/components/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
        <link href="/fr/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link rel="stylesheet" href="/fr/components/highlightjs/styles/github.css" />
        <link rel="alternate" type="application/atom+xml" href="/fr/atom.xml" title="&lt;fabarea/&gt; activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
    </head>
    <body>
        <header>
            <div class="navbar navbar-inverse navbar-fixed-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/fr/">&lt;fabarea/&gt;</a>
                        <div class="nav-collapse collapse">
                            <ul class="nav">
                                <li><a href="/fr/blog">Archives</a></li>
                                <li><a href="/fr/blog/tags">Tags</a></li>
                                <li><a href="/fr/about">A propos</a></li>
                            </ul>
                        </div><!--/.nav-collapse -->
                    </div>
                </div>
            </div>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span8">
                        <article>
        <header>
            <h2>Publication automatique sur le TER depuis Github <small>post</small></h2>
        </header>
        <div>
            <p>Etant le mainteneur <a href="/fr/blog/2015/02/10/github-migration/">de plusieurs extensions</a> pour TYPO3 CMS, j'ai toujours trouvé la phase de "release" sur le <a href="http://typo3.org/extensions/repository/">TER</a> un peu fastidieuse. En fait, L'opération est plus compliquée qu'il n'y paraît. Il ne faut ménager aucun détail sous peine de "manquer la coche", entre les tags Git, les messages de commit, le bon numéro de version. Pour ne pas se fourvoyer, j'ai une check-list que je suis étape par étape. Si tout se passe bien, la procédure prend entre 10 et 15 minutes par extension.</p>

<p>J'avais déjà dans le collimateur plusieurs tentatives qui visaient à automatiser l'upload sur le TER via des Webhooks que propose Github. Il y avait entre autre l'approche de <a href="http://blog.kay-strobach.de/">Kay Strobach</a> avec cette <a href="https://github.com/kaystrobach/TYPO3TerHook/">ébauche</a> de code.</p>

<p>Pour mes besoins, l'idée sous-jacente était de déclencher l'upload via la création d'un tag Git. Ayant discuté la chose avec <a href="https://plus.google.com/+AdrienCrivelli/posts">mon collègue Adrien</a>, nous avons suivi l'approche qui est expliquée de manière approfondie dans <a href="https://github.com/Ecodev/fluidtypo3-gizzle.">un article</a> écrit par <a href="https://twitter.com/namelesscoder">Claus Due</a>. La verbosité de l'article peut laisser transparaître quelque chose de compliquer. Il n'en est rien! La mise en place se résume en quelques étapes.</p>

<h3>Tâches préparatoires</h3>

<ul>
<li>Créer un sous-domaine, e.g. http://release.example.com</li>
<li>Cloner l'extension <a href="https://github.com/Ecodev/fluidtypo3-gizzle">https://github.com/Ecodev/fluidtypo3-gizzle</a>, le dossier "web" devant être à la racine du Document Root.</li>
<li>Ajouter un webhook pour le projet sur GitHub

<ul>
<li>URL: http://release.example.com/?settings=settings/ExtensionRelease.yml</li>
<li>Secret: 12356</li>
</ul></li>
<li>Transférer la clé des extension à un member "release" sur <a href="typo3.org">typo3.org</a>. Cette étape est optionnelle mais conseillée.</li>
</ul>

<h3>Tâches de publication</h3>

<ul>
<li>Mettre à jour le numéro de version dans le fichier <code>ext_emconf.php</code> et <code>composer.json</code>.</li>
<li>Créer un tag et pousser ce tag avec la commande <code>git push --tags</code>, l'extension est uploadé sur TER avec un message générique qui pointe ver le log de Github. Très pratique!</li>
</ul>

<h3>Quelques copies d'écran</h3>

<p><img src="/images/2015-02-20/2015-02-20_2202.png" alt="" /></p>

<p>La mise en place du webhook</p>

<hr />

<p><img src="/images/2015-02-20/2015-02-20_2203.png" alt="" /></p>

<p>L'analyse du paylod permet de vérifier ce qui a été envoyé au Webhook.</p>

<hr />

<p><img src="/images/2015-02-20/2015-02-20_2204.png" alt="" /></p>

<p>Le retour du Webhook qui correspond au message envoyé par le TER.</p>

<p>Cet article <a href="/en/blog/2015/02/20/automatic-ter-release">est disponible</a> en anglais également.</p>

        </div>
                            <p class="tags">
            Tags:
                        <a href="/fr/blog/tags/ter">ter</a>,                         <a href="/fr/blog/tags/github">github</a>                        </p>
        
                    <nav class="article">
                <ul>
                                                                <li>Previous: <a class="previous" href="/fr/blog/2015/02/10/github-migration/" title="Déménagement de mes extensions sur Github"><span class="title">Déménagement de mes extensions sur Github</span></a></li>
                                    </ul>
            </nav>
            </article>

<!-- START: Livefyre Embed -->
<div id="livefyre-comments"></div>
<script type="text/javascript" src="http://zor.livefyre.com/wjs/v3.0/javascripts/livefyre.js"></script>
<script type="text/javascript">
    (function () {
        var articleId = fyre.conv.load.makeArticleId(null);
        fyre.conv.load({}, [{
            el: 'livefyre-comments',
            network: "livefyre.com",
            siteId: "369598",
            articleId: articleId,
            signed: false,
            collectionMeta: {
                articleId: articleId,
                url: fyre.conv.load.makeCollectionUrl(),
            }
        }], function() {});
    }());
</script>
<!-- END: Livefyre Embed -->
                </div>
                <div class="span4 sidebar">
                    <!--<div class="well">-->
                        <!--<h4>&lt;fabarea/&gt; <small>To Get You Started</small></h4>-->
                    <!--</div>-->
                    <!--<div class="well sidebar-nav">-->
                        <!--<h4>Links</h4>-->
                        <!--<ul class="nav">-->
                            <!--<li><a href="http://sculpin.io">sculpin.io</a></li>-->
                            <!--<li><a href="http://twitter.com/getsculpin">@getsculpin</a></li>-->
                        <!--</ul>-->
                    <!--</div>-->
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2015 &lt;fabarea/&gt;
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/fr/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/fr/components/bootstrap/js/bootstrap.min.js"></script>
                
                <script src="/fr/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>
